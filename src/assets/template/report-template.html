<style>
  td,
  th {
    padding: 6px;
    min-width: 100px;
    font-size: 19px;
  }
  .header,
  .footer {
    background: #d9d9d9;
  }
  .bt {
    border-top: 3px solid black;
  }
  .bb {
    border-bottom: 3px solid black;
  }
  .br {
    border-right: 3px solid black;
  }
  .bl {
    border-left: 3px solid black;
  }
  .by {
    border-top: 3px solid black;
    border-bottom: 3px solid black;
  }
  .bx {
    border-right: 3px solid black;
    border-left: 3px solid black;
  }
  .sub-header {
    background: #f2f2f2;
  }
  .text-light {
    font-weight: 300;
  }
  .text-bold {
    font-weight: 900;
  }
  .bb-light {
    border-bottom: 1px solid black;
  }
  .title {
    font-size: 28;
    background: #404040;
    color: #ffffff;
  }
</style>

{{#each data}}
<table name="{{name}}">
  <tr>
    <th class="by bx title" colspan="3">{{name}}</th>
  </tr>
  <tr>
    <th class="bl header">Desde</th>
    <td class="br header" colspan="2">{{ ../dateRange.[0] }}</td>
  </tr>
  <tr>
    <th class="bl bb header">Hasta</th>
    <td class="br bb header" colspan="2">{{ ../dateRange.[1] }}</td>
  </tr>
  <tr>
    <th class="bb bl sub-header">Nombre</th>
    <th class="bb sub-header">Pedidos</th>
    <th class="bb br sub-header">Valor</th>
  </tr>
  {{#each this.users}}
  <tr>
    <td class="bl bb-light">{{startCase name}}</td>
    <td class="bb-light" data-cell-type="number">{{orders.length}}</td>
    <td
      class="br bb-light"
      data-cell-type="number"
      data-cell-format-str="$#,##0"
    >
      {{totalPrice}}
    </td>
  </tr>
  {{/each}}
  <tr>
    <th class="footer by bl">Totales</th>
    <th class="footer by" data-cell-type="formula">
      SUM({{getRange users 'B'}})
    </th>
    <th
      class="footer by br"
      data-cell-type="formula"
      data-cell-format-str="$#,##0"
    >
      SUM({{getRange users 'C'}})
    </th>
  </tr>
</table>
{{/each}}
